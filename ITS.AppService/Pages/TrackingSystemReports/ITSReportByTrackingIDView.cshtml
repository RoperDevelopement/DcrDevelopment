@page
@model Edocs.ITS.AppService.Pages.TrackingSystemReports.ITSReportByTrackingIDViewModel
@{
    ViewData["Title"] = "ITS Reports By TrackingID";
    Layout = "~/Pages/Shared/_Layout.cshtml";
    <link rel="stylesheet" href="~/css/site.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
        input[type=text] {
            padding: 10px;
            font-size: 17px;
            border: 1px solid grey;
            float: left;
            width: 80%;
            background: #f1f1f1;
        }
        button:hover {
            background: #C0C0C0;
        }
        button {
            float: left;
            width: 20%;
            padding: 10px;
            background: #2196F3;
            color: white;
            font-size: 17px;
            border: 1px solid grey;
            border-left: none;
            cursor: pointer;
        }
    </style>

}
<div id="divMain" name="divMain" class="container-fluid">
    @Html.AntiForgeryToken()

    <h2 class="text-center text-dark">e-Docs USA Tracking System Reports By TrackingID</h2>
    <p class="p-0"></p>
    <a href="#searchOptions" name="sOptions" id="sOptions" class=" btn btn-primary text-center" data-toggle="collapse" onmouseout="document.getElementById('showmess').style.display = 'none'" onmouseover="document.getElementById('showmess').style.display = 'block'">Search Options</a>
    <p class="alert-light" id="showmess" style="display:none">Click to expand/hide Search Options</p>
    <p class="p-1" />

    <div id="searchOptions" class="collapse">
        <div class="container-fluid">


            @*
                    <dl class="row">
                        <dt>
                            <span>TrackingID</span>
                        </dt>
                        <dd class="col-sm-8">
                            <input type="text" id="trackID" name="trackID" placeholder="Enter TrackingID" />
                        </dd>
                    </dl>
                </div>
            *@
            <div style="margin:auto;max-width:300px">
                <input type="text" placeholder="Search By TrackingID..." id="trackID" name="trackID">
                <button id="lookupTrackingID" name="lookupTrackingID"><i class="fa fa-search"></i></button>
                <p class="p-2"></p>
                @*  <button style="width:100%" id="allIDs" type="submit"><i>All TrackingID's</i></button>*@
            </div>
            <p class="p-lg-4"></p>
            <div class="row text-center">
                <div class="col-*-* text-center" style="margin:0 auto;">
                    <a type="button" class="btn btn-outline-dark btn-block btn-link" href="/TrackingSystemReports/ITSReportByTrackingIDView" id="btnReset" name="btnReset">Reset</a>
                </div>
                <div class="col-*-* text-center" style="margin:0 auto;">
                    <a type="button" class="btn btn-outline-dark btn-block btn-link" id="btnExit" href="/Index" name="btnExit">Exit</a>
                </div>
            </div>






        </div>
    </div>
    <br />
    <br />
    <br />
    <div id="printInvoice" style="display:none">
        <div id="trackingID"></div>

    </div>
    <p class="p-2">
        <button class="btn btn-info"  id="prInvoice" style="display:none;float:right;">Print Report</button>
    </p>
</div>
    <div id="divLoading" style="margin: 0px; padding: 0px; position: fixed; right: 0px;
                top: 0px; width: 100%; height: 100%; background-color: #666666; z-index: 30001;
                opacity: .8; filter: alpha(opacity=70);display:none">
        <p id="parLoading" style="position: absolute; top: 30%; left: 45%; color: White;">
            Getting data, please wait...<img src="~/Images/ajax-loading.gif">
        </p>
    </div>
    @section scripts{
        <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.min.js" integrity="sha256-eTyxS0rkjpLEo16uXTS0uVCS4815lc40K2iVpWDvdSY=" crossorigin="anonymous"></script>
        @*  <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/start/jquery-ui.css">*@
        <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
        <script>
            $(document).ready(function () {

                $("#trackID").autocomplete({

                    source: function (request, response) {
                        
                        $.ajax({
                            url: '/Partial_Pages/GetTackingIDSProjectNamePartialPage',
                            data: { "prefix": request.term },
                        
                            type: "POST",
                            beforeSend: function (xhr) {
                                xhr.setRequestHeader("XSRF-TOKEN",
                                    $('input:hidden[name="__RequestVerificationToken"]').val());
                            },
                            success: function (data) {
                                response($.map(data, function (item) {
                                    return item;
                                }))
                            },
                            error: function (response) {
                                alert(response.responseText);
                            },
                            failure: function (response) {
                                alert(response.responseText);
                            }
                        });
                    },
                    select: function (e, i) {
                        //  get selected value;
                        //$("#personNameValue").val(i.item.val);
                    },
                    minLength: 1
                });
                $('#prInvoice').click(function () {
                    printOut('printInvoice');
                });
                $('#allIDs').click(function (e) {
                    $('#trackID').val('All TrackingIDs');
                    $('#lookupTrackingID').click();

                });
                $('#lookupTrackingID').click(function (e) {

                    $("#divLoading").show();
                    e.preventDefault();

                    var getUsersProfiles = "/Partial_Pages/PartailPageReportByTrackindIDPName/";
                    var strData = "trackIDPname=" + $('#trackID').val();
                    $.ajax({
                        type: "GET",
                        url: getUsersProfiles,
                        contentType: 'application/html;charset=utf-8',
                        data: strData,
                        datatype: "html",
                        cache: false,
                        success: function (results) {

                            $('#trackingID').show();
                            $('#printInvoice').show();
                            $('#prInvoice').show();
                            
                            //  $('#saveInvoice').hide();
                            $("#trackingID").html(results);
                            //Convert Base64 string to Byte Array.
                            // var bytes = Base64ToBytes(r.Data);

                            //  LoadPdfFromBlob(bytes);
                        },
                        complete: function () {
                            //   CompleteAjaxCall();
                            $('#trackID').val('');
                            $("#divLoading").hide();
                            $("#sOptions").click();
                            // $('#dtlUsers').DataTable({ "pagingType": "full" });
                            // $('.dataTables_length').addClass('bs-select');

                        },
                        error: function (request, status, error) {
                            $("#divLoading").hide();
                            alert(error);
                            alert(request.getAllResponseHeaders());
                            alert(status.show);
                        }
                    });

                });


            });
        </script>
    }
