@page
@model BinMonitorAppService.Pages.LookUp.SpectrumMonitorReportsByCwidViewModel
@{
    ViewData["Title"] = "Spectrum Reports By  Cwid";
    Layout = "~/Pages/Shared/_Layout_BinMonitor.cshtml";
}

<div id="headingSessionExp" style="display:none">
    <h3 class="text-center text-danger">Page BinMonitor Report will refresh in&nbsp;<span id="seconds"></span>&nbsp;seconds.<br /></h3>
</div>
<div class="container-fluid small" style="background-color:#ffffff">
    <p class="p-2" />
    <header>
        <h3 class="text-center">Report By CWID Date Range @Model.UsageRepStDate.ToString("MM-dd-yyyy") - @Model.UsageRepEndDate.ToString("MM-dd-yyyy")</h3>
    </header>
    <p class="p-0"></p>
    <form method="get" id="fmUsgRep" name="fmUsgRep">
        <div class="form-group text-center">
            <div class="row" style="display:table;margin:auto">

                <div class="col">
                    @Html.LabelFor(model => Model.UsageRepStDate, new { @class = "text-left" })
                    @Html.EditorFor(m => Model.UsageRepStDate, new { @name = "UsageRepStDate", @id = "UsageRepStDate" })
                </div>
                <p class="p-0"></p>
                <div class="col">
                    <p asp-for="UsageRepStDate">
                        @Html.LabelFor(model => Model.UsageRepEndDate, new { @class = "text-left" })
                        @Html.EditorFor(m => @Model.UsageRepEndDate, new { @name = "UsageRepEndDate", @id = "UsageRepEndDate" })
                    </p>
                </div>
                <p class="p-0"></p>
                <div class="col">
                    @Html.LabelFor(model => Model.ReportType, new { @class = "text-left" })
                    @Html.DropDownList("ReportType",
                                         new SelectList(Enum.GetValues(typeof(DropListBinCwidRepOptions))),
                                         new { @onclick = "this.submit()" })
                </div>
                <p class="p-0"></p>
                <div class="col">
                    @Html.LabelFor(model => Model.CategoryName, new { @class = "text-left" })

                    @Html.DropDownListFor(m => m.CategoryName,
                 new SelectList(Model.CategoryName, "CategoryName"), new { @name = "CategoryName", @id = "CategoryName", @class = "form-conrol", @onchange = "this.submit()" })

                </div>
                <p class="p-0"></p>
                <div class="col">
                    @Html.LabelFor(model => Model.ActiveUsers, new { @class = "text-left" })

                    @Html.DropDownListFor(m => m.ActiveUsers,
                 new SelectList(Model.ActiveUsers, "ActiveUsers"), new { @name = "ActiveUsers", @id = "ActiveUsers" })

                </div>
                <p class="p-0"></p>


            </div>
        </div>
    </form>
    <div class="text-center">

        <button class="btn btn-outline-primary " id="subcrbatch" name="subcrbatch">Generate Report</button>
        @*
        <button class="btn btn-outline-secondary " id="export" name="export">Export</button>
        *@


        <a href="https://edocsnypbinmonitor.azurewebsites.net/LookUp/SpectrumMonitorReportsByCwidView"><input type="button" value="Reset" class="btn btn-outline-warning" id="reset"></a>
        <a href="https://edocsnypbinmonitor.azurewebsites.net/BinManager/ViewManagerHome"><input type="button" value="Exit" id="exitcrb" class="btn btn-outline-dark"></a>
    </div>
    <p class="p-0"></p>
    <div class="container-fluid">
        @if ((@Model.ReportByCWIDCatStatus != null) && (@Model.ReportByCWIDCatStatus.Count > 0))
        {

            <h4 class="text-center text-info">Bin Search Status:@Model.BinStatus</h4>
            <table class="table-bordered table-hover  table-primary" style="margin:auto" width="50%">

                <thead>
                    <tr class="flex-nowrap">
                        <th>Bin Process Status</th>
                        <th>Bin Status</th>
                        <th>Bin ID</th>
                        <th>CWID</th>
                        <th>Category Name</th>
                        <th>Total LabReqs in Bin</th>
                        <th>Category Duration</th>
                    </tr>

                </thead>
                <tbody>
                    <tr class="blank_row">
                        <td bgcolor="#adadad" colspan="7">&nbsp;</td>
                    </tr>
                    @foreach (var item in @Model.ReportByCWIDCatStatus)
                    {
                        @if ((string.Compare(Model.BinStatus, "Register", true) == 0) || (string.Compare(Model.BinStatus, "All", true) == 0))
                        {
                            <tr>
                                <td>Registered</td>
                                <td>@item.Value.BinStatusReg</td>
                                <td>@item.Value.BinID</td>
                                <td>@item.Value.RegAssignedTo</td>
                                <td>@item.Value.CategoryName</td>
                                <td>@item.Value.TotalVol</td>
                                <td>@item.Value.RegDuration</td>
                            </tr>

                        }
                        @if ((string.Compare(Model.BinStatus, "Processing", true) == 0) || (string.Compare(Model.BinStatus, "All", true) == 0))
                        {
                            <tr>
                                <td>Processing</td>
                                <td>@item.Value.BinStatusProcessing</td>
                                <td>@item.Value.BinID</td>
                                <td>@item.Value.ProcessAssignedTo</td>
                                <td>@item.Value.CategoryName</td>
                                <td>@item.Value.TotalVol</td>
                                <td>@item.Value.ProcessDuration</td>
                            </tr>
                        }
                        @if ((string.Compare(Model.BinStatus, "Closed", true) == 0) || (string.Compare(Model.BinStatus, "All", true) == 0))
                        {
                            <tr>
                                <td>Closed</td>
                                <td>@item.Value.BinStatusClosed</td>
                                <td>@item.Value.BinID</td>
                                <td>@item.Value.BinClosedBy</td>
                                <td>@item.Value.CategoryName</td>
                                <td>@item.Value.TotalVol</td>
                                <td>@item.Value.CompleteDuration</td>
                            </tr>
                        }

                        <tr class="blank_row">
                            <td bgcolor="#adadad" colspan="7">&nbsp;</td>
                        </tr>
                    }
                    @*
                        < tr class="blank_row">
                            <td bgcolor="#FFFFFF" colspan="7">&nbsp;</td>
                        </tr>
                    *@
                    }


                </tbody>
            </table>
        }
        else
        {
            @if (!(string.IsNullOrWhiteSpace(@Model.BinStatus)))
            {
                <h4 class="text-center text-info">No Bins found for Status @Model.BinStatus</h4>
            }
        }
        <p class="p-1"></p>
    </div>
</div>
<div id="divLoading" style="margin: 0px; padding: 0px; position: fixed; right: 0px;
    top: 0px; width: 100%; height: 100%; background-color: #666666; z-index: 30001;
    opacity: .8; filter: alpha(opacity=70);display:block">
    <p id="parBmUpScreen" name="parCategory" style="position: absolute; top: 30%; left: 45%; color: White;">
        Loading Reports please wait...<img src="~/Images/ajax-loading.gif">
    </p>
</div>
<script>
    $(document).ready(function () {
        $("#divLoading").hide();
        SessionExpireAlert(0);
        $(this).bind("contextmenu", function (e) {
            e.preventDefault();
        });
        $('#subcrbatch').click(function () {
            $("#divLoading").show();
            $("<input type='hidden'/>")
                .attr("value", "")
                .attr("id", "export")
                .attr("name", "export")
                .prependTo("#fmUsgRep");
            $('#fmUsgRep').submit();
        });
        $('#export').click(function () {

            $("<input type='hidden'/>")
                .attr("value", "exportRep")
                .attr("id", "export")
                .attr("name", "export")
                .prependTo("#fmUsgRep");
            $('#fmUsgRep').submit();
        });

    });</script>
