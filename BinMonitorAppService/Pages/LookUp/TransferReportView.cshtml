@page
@model BinMonitorAppService.Pages.LookUp.TransferReportViewModel
@{
    ViewData["Title"] = "Transfer Report";
    Layout = "~/Pages/Shared/_Layout_BinMonitor.cshtml";
}

<div id="headingSessionExp" style="display:none">
    <h3 class="text-center text-danger">Page BinMonitor Report will refresh in&nbsp;<span id="seconds"></span>&nbsp;seconds.<br /></h3>
</div>
<div class="container-fluid small" style="background-color:#ffffff">
    <p class="p-2" />
    <header>
        <h3 class="text-center">Tansfer Report  Date Range @Model.UsageRepStDate.ToString("MM-dd-yyyy") - @Model.UsageRepEndDate.ToString("MM-dd-yyyy")</h3>
    </header>
    <p class="p-0"></p>

    <form method="get" id="fmtransRep" name="fmtransRep">
        <div class="form-group text-center">
            <div class="row" style="display:table;margin:auto">

                <div class="col">
                    @Html.LabelFor(model => Model.UsageRepStDate, new { @class = "text-left" })
                    @Html.EditorFor(m => Model.UsageRepStDate, new { @name = "UsageRepStDate", @id = "UsageRepStDate" })
                </div>
                <p class="p-0"></p>
                <div class="col">
                    <p asp-for="UsageRepStDate">
                        @Html.LabelFor(model => Model.UsageRepEndDate, new { @class = "text-left" })
                        @Html.EditorFor(m => @Model.UsageRepEndDate, new { @name = "UsageRepEndDate", @id = "UsageRepEndDate" })
                    </p>
                </div>
                <p class="p-0"></p>
                <div class="col">
                    <select id="transtypevalue" name="transtypevalue">
                        <option value="Select Transfer">Select Transfer</option>
                        <option value="All">All</option>
                        <option value="1">Bins</option>
                        <option value="2">Categories</option>
                        <option value="4">LabReqs</option>
                        <option value="3">Processing</option>
                    </select>
                    <p class="text-center text-danger" style="display:none" id="trError" name="trError">*Invalid Transfer Option Selected*</p>
                </div>
                <p class="p-0"></p>

                <p class="p-0"></p>


            </div>
        </div>

    </form>
    <div class="text-center">
        <button class="btn btn-outline-primary " id="btnTransRep" name="btnTransRep">Generate Report</button>
        <a href="https://edocsnypbinmonitor.azurewebsites.net/LookUp/TransferReportView"><input type="button" value="Reset" class="btn btn-outline-warning" id="reset"></a>
        <a href="https://edocsnypbinmonitor.azurewebsites.net/BinManager/ViewManagerHome"><input type="button" value="Exit" id="exitcrb" class="btn btn-outline-dark"></a>
        <p class="p-1"></p>
    </div>


</div>
<p class="p-1"></p>
<div id="tabTrans" class="container-fluid">

</div>

<div id="divLoading" style="margin: 0px; padding: 0px; position: fixed; right: 0px;
    top: 0px; width: 100%; height: 100%; background-color: #666666; z-index: 30001;
    opacity: .8; filter: alpha(opacity=70);display:block">
    <p id="parBmUpScreen" name="parCategory" style="position: absolute; top: 30%; left: 45%; color: White;">
        Loading Reports please wait...<img src="~/Images/ajax-loading.gif">
    </p>
</div>
@section scripts
     {
    <script type="text/javascript">
        $(document).ready(function () {
            $("#divLoading").hide();
            //   SessionExpireAlert($('#expiresSession').val());
            $(this).bind("contextmenu", function (e) {

                e.preventDefault();

            });
            $('#btnTransRep').click(function () {
                //if (($('transtypevalue').val().length == 0))// || ($('transtypevalue').val() == "Select Transfer"))
               
                if (($('#transtypevalue').val() == "Select Transfer")) {
                     
                    $('#trError').attr("style", "display:block");
                    
                    return false;
                }
                $("#divLoading").show();
                //e.preventDefault();

                var sDate = $("#UsageRepStDate").val().replace('/', '-');
                var eDate = $("#UsageRepEndDate").val().replace('/', '-');
                //var tType = $("#transtypevalue").val();
                var pvUrl = "/Partial_Pages/ReportTransfer?repSDate=" + sDate + "&repEDate=" + eDate + "&transType=" + $("#transtypevalue").val();

                // e.preventDefault()
                $.ajax({
                    type: "GET",
                    url: pvUrl,
                    contentType: 'application/html; charset=utf-8',
                    dataType: 'html',
                    cache: false,
                    success: function (result) {
                        $("#tabTrans").html(result);

                        //  $("#resuts").val(result);
                        $('#usequickkeys').val('no');

                    },
                    complete: function () {
                        if ($("#dttransferTab").length) {
                            $('#dttransferTab').DataTable({ "pagingType": "full", "pageLength": 100 });
                            $('.dataTables_length').addClass('bs-select');
                        }

                        $("#divLoading").hide();
                    },
                    error: function (request, status, error) {
                        alert('request ' + request + ' status ' + status + ' error ' + error);
                    }
                });
            });
            //$('#transRep').click(function () {
            //    $("#divLoading").show();
            //    e.preventDefault();
            //    var sDate = $("#UsageRepStDate").val().replace('/', '-');
            //    var eDate = $("#UsageRepEndDate").val().replace('/', '-');
            //    var tType = = $("#transtype").val();
            //    alert(tType);
            //    var pvUrl = "/Partial_Pages/TransferReportView?repSDate=" + sDate + "/repEDate=" + eDate + "/transType=" + tType;
            //    //$.ajax({
            //    //    type: "GET",
            //    //    url: pvUrl,
            //    //    contentType: 'application/html; charset=utf-8',
            //    //    dataType: 'html',
            //    //    cache: false,
            //    //    success: function (result) {
            //    //        $("#tabTrans").html(result);

            //    //        //  $("#resuts").val(result);
            //    //        $('#usequickkeys').val('no');

            //    //    },
            //    //    complete: function () {
            //    //        //if ($("#dtBinStatus").length) {
            //    //        //    $('#dtBinStatus').DataTable({ "pagingType": "full", "pageLength": 100 });
            //    //        //    $('.dataTables_length').addClass('bs-select');
            //    //        //}

            //    //        $("#divLoading").hide();
            //    //    },
            //    //    error: function (request, status, error) {
            //    //        alert('request ' + request + ' status ' + status + ' error ' + error);
            //    //    }
            //    //});
            //});
        });
    </script>
}
